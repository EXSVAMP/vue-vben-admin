import{i as t,s as n,ac as e,d as a,B as o,a as u,ad as s,r,o as l,f as i,p as c,q as d,t as f,m as p,ae as m,u as v,g as C}from"./index.aa8837b6.js";import{I as S}from"./index.205d70bf.js";import{u as b}from"./useFormItem.60294112.js";var x=a({name:"CountButton",components:{Button:o},props:{count:{type:Number,default:60},beforeStartFunc:{type:Function,default:null}},setup(a){const o=t(!1),{currentCount:r,isStart:l,start:i}=function(a){const o=t(a),u=t(!1);let s;function r(){s&&window.clearInterval(s)}function l(){u.value=!1,s=null,r()}function i(){n(u)||s||(u.value=!0,s=setInterval((()=>{1===n(o)?(l(),o.value=a):o.value-=1}),1e3))}function c(){o.value=a,l()}return e((()=>{c()})),{start:i,reset:c,restart:function(){c(),i()},clear:r,stop:l,currentCount:o,isStart:u}}(a.count),{t:c}=u();return{handleStart:async function(){const{beforeStartFunc:t}=a;if(t&&s(t)){o.value=!0;try{await t()&&i()}finally{o.value=!1}}else i()},isStart:l,currentCount:r,loading:o,t:c}}});x.render=function(t,n,e,a,o,u){const s=r("Button");return l(),i(s,p(t.$attrs,{disabled:t.isStart,onClick:t.handleStart,loading:t.loading}),{default:c((()=>[d(f(t.isStart?t.t("component.countdown.sendText",[t.currentCount]):t.t("component.countdown.normalText")),1)])),_:1},16,["disabled","onClick","loading"])};var g=a({name:"CountDownInput",components:{[S.name]:S,CountButton:x},props:{value:m.string,size:m.oneOf(["default","large","small"]),count:m.number.def(60),sendCodeApi:{type:Function,default:null}},setup(t){const{prefixCls:n}=v("countdown-input"),[e]=b(t);return{prefixCls:n,state:e}}});g.render=function(t,n,e,a,o,u){const s=r("CountButton"),d=r("AInput");return l(),i("div",{class:t.prefixCls},[C(d,p(t.$attrs,{size:t.size,value:t.state,"onUpdate:value":n[1]||(n[1]=n=>t.state=n)}),{addonAfter:c((()=>[C(s,{size:t.size,count:t.count,beforeStartFunc:t.sendCodeApi},null,8,["size","count","beforeStartFunc"])])),_:1},16,["size","value"])],2)};export{g as _};
