var e=Object.assign;import{ae as t,d as n,i as s,c as l,a5 as o,D as i,bU as a,s as c,g as d,aS as r,K as u,aR as m,dt as p,du as f,aw as v}from"./index.8ee268f5.js";import{M as y}from"./index.704d9bda.js";/* empty css              */import{D as h}from"./index.8a231396.js";const b={width:t.number.def(156),customEvent:{type:Object,default:null},styles:t.style,showIcon:t.bool.def(!0),axis:{type:Object,default:()=>({x:0,y:0})},items:{type:Array,default:()=>[]}};const x=e=>{const{item:t}=e;return d("span",{style:"display: inline-block; width: 100%;",onClick:e.handler.bind(null,t)},[e.showIcon&&t.icon&&d(m,{class:"mr-2",icon:t.icon},null),d("span",null,[t.label])])};var w=n({name:"ContextMenu",props:b,setup(t){const n=s(null),m=s(!1),p=l((()=>{const{axis:n,items:s,styles:l,width:o}=t,{x:i,y:a}=n||{x:0,y:0},c=40*(s||[]).length,d=o,r=document.body,u=r.clientWidth<i+d?i-d:i,m=r.clientHeight<a+c?a-c:a;return e(e({},l),{width:`${o}px`,left:`${u+1}px`,top:`${m+1}px`})}));function f(e,t){const{handler:n,disabled:s}=e;s||(m.value=!1,null==t||t.stopPropagation(),null==t||t.preventDefault(),null==n||n())}function v(e){return e.map((e=>{const{disabled:n,label:s,children:l,divider:o=!1}=e,i=o?d(h,{key:`d-${s}`},null):null;return l&&0!==l.length?c(m)?d(y.SubMenu,{key:s,disabled:n,popupClassName:"context-menu__popup"},{title:()=>d(x,{showIcon:t.showIcon,item:e,handler:f},null),default:()=>v(l)}):null:d(r,null,[d(y.Item,{disabled:n,class:"context-menu__item",key:s},{default:()=>[d(x,{showIcon:t.showIcon,item:e,handler:f},null)]}),i])}))}return o((()=>{i((()=>m.value=!0))})),a((()=>{const e=c(n);e&&document.body.removeChild(e)})),()=>{let e;const{items:s}=t;return c(m)?d(y,{inlineIndent:12,mode:"vertical",class:"context-menu",ref:n,style:c(p)},"function"==typeof(l=e=v(s))||"[object Object]"===Object.prototype.toString.call(l)&&!u(l)?e:{default:()=>[e]}):null;var l}}});const j={domList:[],resolve:()=>{}},E=function(e){const{event:t}=e||{};if(t&&(null==t||t.preventDefault()),p)return new Promise((n=>{const s=document.body,l=document.createElement("div"),o={};e.styles&&(o.styles=e.styles),e.items&&(o.items=e.items),e.event&&(o.customEvent=t,o.axis={x:t.clientX,y:t.clientY});const i=d(w,o);f(i,l);const a=function(){j.resolve("")};j.domList.push(l);const c=function(){j.domList.forEach((e=>{try{e&&s.removeChild(e)}catch(t){}})),s.removeEventListener("click",a),s.removeEventListener("scroll",a)};j.resolve=function(...e){c(),n(e[0])},c(),s.appendChild(l),s.addEventListener("click",a),s.addEventListener("scroll",a)}))},I=function(){j&&(j.resolve(""),j.domList=[])};function L(e=!0){return v()&&e&&a((()=>{I()})),[E,I]}export{L as u};
